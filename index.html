<div>
    <h1>Scan QR code</h1>

    <video id="videoElement" autoplay playsinline muted style="width: 300px; height: 300px; background-color: cadetblue;"></video>
    <p id="msg" style="color: red;"></p> <!-- Элемент для вывода сообщений -->
    <script>
        const setMsg = (msg) => {
            document.getElementById("msg").innerHTML = msg;
        };

        async function initCamera() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({
                    video: {
                        facingMode: { exact: "environment" } // Запрос задней камеры
                    },
                    audio: false
                });
                const video = document.getElementById("videoElement");

                video.srcObject = stream;

                video.onloadedmetadata = () => {
                    video.play();
                    setMsg("Metadata loaded. Video should be playing.");
                };

                video.onplay = () => {
                    setMsg("Video is playing.");
                };

                video.onpause = () => {
                    setMsg("Video is paused.");
                };

                video.onerror = (e) => {
                    setMsg("Video error: " + e.message);
                };
            } catch (error) {
                setMsg("Ошибка при доступе к камере: " + error.message);
            }
        }

        document.addEventListener("DOMContentLoaded", () => {
            initCamera();
            setMsg("Initializing camera...");
        });
    </script>
</div>
